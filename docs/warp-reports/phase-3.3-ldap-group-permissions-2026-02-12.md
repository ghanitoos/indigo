# Phase 3.3: مدیریت دسترسی گروه‌های LDAP

## 1. خلاصه اجرایی (Executive Summary)
در این فاز، قابلیت مدیریت دسترسی گروه‌های LDAP به ماژول‌های سیستم پیاده‌سازی شد. مدیر سیستم اکنون می‌تواند لیست گروه‌های موجود در LDAP را مشاهده کرده، آنها را به عنوان Role به سیستم اضافه کند و دسترسی هر گروه به ماژول‌های مختلف را از طریق یک رابط کاربری ساده مدیریت نماید.

## 2. تاریخ و زمان
تاریخ: 2026-02-12
ساعت شروع: 07:15
ساعت پایان: 07:45
مدت زمان: 30 دقیقه

## 3. فایل‌های ایجاد شده
- **/opt/admin-panel/core-app/modules/admin/templates/admin/group_permissions.html**
  توضیح: رابط کاربری مدیریت دسترسی‌ها شامل لیست گروه‌ها، افزودن گروه جدید و مدیریت مجوزها.
  
- **/opt/admin-panel/core-app/static/js/admin_groups.js**
  توضیح: کدهای جاوااسکریپت برای تعامل AJAX با سرور جهت ذخیره تغییرات و حذف گروه‌ها.

## 4. فایل‌های تغییر یافته
- **core-app/auth/ldap_connector.py**:
  * اضافه شده: متد `get_all_groups()` به کلاس `LDAPConnector`.
  * توضیح: این متد لیست تمام گروه‌ها را از LDAP فراخوانی می‌کند (شامل CN و تعداد اعضا).
  
- **core-app/models/rbac.py**:
  * اضافه شده: متد کلاس `create_from_ldap_group(ldap_group_cn)` به مدل `Role`.
  * توضیح: این متد بررسی می‌کند اگر Role با نام گروه وجود ندارد، آن را ایجاد می‌کند.

- **core-app/modules/admin/routes.py**:
  * اضافه شده: مسیرهای `/group-permissions` (نمایش صفحه)، `/group-permissions/add` (افزودن گروه) و `/group-permissions/update/<id>` (بروزرسانی دسترسی‌ها).
  * توضیح: منطق سمت سرور برای مدیریت درخواست‌های UI.

- **core-app/translations/de.json**:
  * اضافه شده: کلیدهای ترجمه جدید زیرمجموعه `admin.group_permissions`.
  * توضیح: متن‌های آلمانی مورد نیاز برای رابط کاربری جدید.

## 5. تغییرات Database
هیچ تغییر ساختاری (Migration) در دیتابیس انجام نشد. از جداول موجود `roles` و `permissions` و `role_permissions` استفاده شد.
رکوردهای جدید در جدول `roles` به ازای هر گروه LDAP که توسط ادمین اضافه شود، درج خواهد شد.

